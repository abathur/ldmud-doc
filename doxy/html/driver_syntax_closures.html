<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>LDMud: closures</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">LDMud
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('driver_syntax_closures.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">closures </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Closure: <code>closure</code> </p>
<dl class="section user"><dt>note: This is the official man page concerning closures. If you find it hard to read maybe the Closure Guide is an easier introduction for you: See  driver_syntax_closure_guide "closures" and  driver_syntax_closures-example "closures example".</dt><dd></dd></dl>
<p>Closures provide a means of creating code dynamically and passing pieces of code as parameters, storing them in variables. One might think of them as a very advanced form of <a class="el" href="classefun.html#a58338c1e30d3a60a84db85cc2680684b" title="Searches string str for occurences of a &quot;value by function call&quot;, which is an implicit function call ...">efun::process_string()</a>. However, this falls short of what you can actually do with them.</p>
<p>The simplest kind of closures are efuns, lfuns or operators. For example, <code>#'this_player</code> is an example of a closure. You can assign it to a variable as in:</p>
<div class="fragment"><div class="line">closure f;</div>
<div class="line"><span class="keywordtype">object</span> p;</div>
<div class="line">f = #<span class="stringliteral">&#39;this_player;</span></div>
</div><!-- fragment --><p> and later use either the <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> or <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a> efun to evaluate it. Like:</p>
<div class="fragment"><div class="line">p = funcall(f);</div>
</div><!-- fragment --><p> or:</p>
<div class="fragment"><div class="line">p = apply(f);</div>
</div><!-- fragment --><p> In both cases there p will afterwards hold the value of <code>this_player()</code>. Of course, this is only a rather simple application.</p>
<p>Inline closures are a variant of lfun closures, the difference being that the function text is written right where the closure is used. Since they are pretty powerful by themselves, inline closures have their own manpage.</p>
<p>More useful instances of closures can be created using the <a class="el" href="classefun.html#a4ef2926c525dcf7e7d339d3f424b18a9" title="Constructs a lambda closure, like lambda function in LISP. ">efun::lambda()</a> efun. It is much like the lambda function in LISP. For example, you can do the following:</p>
<div class="fragment"><div class="line">f = lambda( ({ <span class="stringliteral">&#39;x }), ({ #&#39;</span>environment, <span class="stringliteral">&#39;x }) );</span></div>
</div><!-- fragment --><p> This will create a lambda closure and assign it to f. The first argument to lambda is an array describing the arguments (symbols) passed to the closure upon evaluation by <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> or <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a>. You can now evaluate f, for example by means of <code>funcall(f,this_object())</code>. This will result in the following steps:</p>
<ol type="1">
<li>The value of <code>this_object()</code> will be bound to symbol x.</li>
<li><code>environment(x)</code> evaluates to <code>environment(this_object())</code> and is returned as the result of the <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a>. One might wonder why there are two functions, <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> and <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a>, to perform the seemingly same job, namely evaluating a closure. Of course there is a subtle difference. If the last argument to <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a> is an array, then each of its elements gets expanded to an additional paramater. The obvious use would be <code>#'call_other</code> as in:</li>
</ol>
<div class="fragment"><div class="line">mixed eval(<span class="keywordtype">object</span> ob,<span class="keywordtype">string</span> func,mixed *args) {</div>
<div class="line">  <span class="keywordflow">return</span> apply(#<span class="stringliteral">&#39;call_other,ob,func,args);</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --><p> This will result in calling <code>ob-&gt;func(args[0],args[1],...,args[sizeof(args)-1])</code>. Using <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> instead of <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a> would have given us <code>ob-&gt;func(args)</code>.</p>
<p>Of course, besides efuns there are closures for &gt;&gt;:concept:<code>operators</code>&lt;&lt;, like `#'+<code>,</code>#'-<code>,</code>#'&lt;<code>,</code>#'&amp;&amp;`, etc.</p>
<p>Well, so far closures have been pretty much limited despite their obvious flexibility. This changes now with the introduction of conditional and loop operators. For example, try:</p>
<div class="fragment"><div class="line">closure max;</div>
<div class="line">max = lambda(</div>
<div class="line">  ({ <span class="stringliteral">&#39;x, &#39;</span>y }),</div>
<div class="line">  ({</div>
<div class="line"><span class="preprocessor">    #&#39;?,</span></div>
<div class="line"><span class="preprocessor"></span>    ({ #<span class="stringliteral">&#39;&gt;, &#39;</span>x, <span class="stringliteral">&#39;y }),</span></div>
<div class="line"><span class="stringliteral">    &#39;</span>x,</div>
<div class="line">    <span class="stringliteral">&#39;y</span></div>
<div class="line"><span class="stringliteral">  })</span></div>
<div class="line"><span class="stringliteral">);</span></div>
<div class="line"><span class="stringliteral">return funcall(max,7,3);</span></div>
</div><!-- fragment --><p> The above example will return 7. What happened? Of course `#'?` is the conditional operator and its 'syntax' is as follows:</p>
<div class="fragment"><div class="line">({ #<span class="stringliteral">&#39;?, cond1, val1, cond2, val2, ..., condn, valn, valdefault });</span></div>
</div><!-- fragment --><p> It evaluates cond1, cond2, ..., condn successively until it gets a nonzero result and then returns the corresponding value. If there is no condition evaluating to a nonzero result, valdefault gets returned. If valdefault is omitted, 0 gets returned. `#'?!<code>works just like</code>#'?<code>, except that the</code><code>is applied to conditions before testing. Therefore, while</code>#'?<code>is somewhat like an if statement,</code>#'?!` resembles an if_not statement if there were one.</p>
<p>There are also loops:</p>
<div class="fragment"><div class="line">({ #<span class="stringliteral">&#39;do, loopbody1, ..., loopbodyN, loopcond, loopresult })</span></div>
</div><!-- fragment --><p> will evaluate the loopbodies until loopcond evaluates to 0 and then return the value of loopresult. Symbols may be used as variables, of course.:</p>
<div class="fragment"><div class="line">({ #<span class="stringliteral">&#39;while, loopcond, loopresult, loopbody1, ..., loopbodyN })</span></div>
</div><!-- fragment --><p> works similar but evaluates loopcond before the loopbodies.</p>
<p>The <a class="el" href="driver_syntax_foreach.html">foreach</a> loop also has a closure form:</p>
<div class="fragment"><div class="line">({ #<span class="stringliteral">&#39;foreach, &#39;</span>var, expr, loopbody1, ..., loopbodyN })</div>
<div class="line">({ #<span class="stringliteral">&#39;foreach, ({ &#39;</span>var1, ..., <span class="stringliteral">&#39;varN}) , expr, loopbody1, ..., loopbodyN })</span></div>
</div><!-- fragment --><p> Now on to a couple of tricky things:</p>
<ol type="1">
<li>How do I write down an array within a lambda closure to avoid interpretation as a subclosure? <code>({ #'member, ({ "abc", "xyz" }), 'x })</code> will result in an error as soon as <a class="el" href="classefun.html#a4ef2926c525dcf7e7d339d3f424b18a9" title="Constructs a lambda closure, like lambda function in LISP. ">efun::lambda()</a> tries to interpret "abc" as a closure operator. The solution is to quote the array, as in: `({ #'member, '({ "abc", "xyz" }), 'x })`. Applying <a class="el" href="classefun.html#a4ef2926c525dcf7e7d339d3f424b18a9" title="Constructs a lambda closure, like lambda function in LISP. ">efun::lambda()</a> to this will not result in an error. Instead, the quote will be stripped from the array and the result regarded as a normal array literal. The same can be achieved by using <a class="el" href="classefun.html#a78e86c560d9bfc454fc228b3988db651" title="Converts arrays to quoted arrays and strings to symbols. ">efun::quote()</a>, e.g.:</li>
</ol>
<div class="fragment"><div class="line">({ #<span class="stringliteral">&#39;member, quote( ({ &quot;abc&quot;, &quot;xyz&quot; }), &#39;</span>x ) })</div>
</div><!-- fragment --><ol type="1">
<li>Isn't it a security risk to pass, say, a closure to the master object which then evaluates it with all the permissions it got? Luckily, no. Each closure gets upon compilation bound to the object defining it. That means that executing it first sets <code>this_object()</code> to the object that defined it and then evaluates the closure. This also allows us to call lfuns which might otherwise be undefined in the calling object.</li>
</ol>
<p>There is however, a variant of <a class="el" href="classefun.html#a4ef2926c525dcf7e7d339d3f424b18a9" title="Constructs a lambda closure, like lambda function in LISP. ">efun::lambda()</a>, called <a class="el" href="classefun.html#ad7e5e12d8853c0b52534f8a8e57dcef6" title="Constructs a lambda closure that is not bound to an object, like lambda function in LISP...">efun::unbound_lambda()</a>, which works similar but does not allow the use of lfuns and does not bind the closure to the defining object. The drawback is that trying to evaluate it by <a class="el" href="classefun.html#aaf018e933ee843dfe67f2916aeeb51a1" title="Evaluates the closure cl with the following arguments. ">efun::apply()</a> or <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> will result in an error. The closure first needs to be bound by calling <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a>. <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a> normally takes one argument and transforms an unbound closure into a closure bound to the object executing the <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a>.</p>
<p>Privileged objects, like the master and the simul_efun object (or those authorized by <a class="el" href="classmaster.html#afaf1545f7ccfbb3d897293150f5a45ca" title="Validate the execution of a privileged operation. ">master::privilege_violation()</a>) may also give an object as the second argument to <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a>. This will bind the closure to that object. A sample application is:</p>
<div class="fragment"><div class="line">dump_object(ob)</div>
<div class="line"><span class="comment">// will dump the variables of ob to /dump.o</span></div>
<div class="line">{</div>
<div class="line">  closure save;</div>
<div class="line">  save = unbound_lambda( ({ }), ({ #<span class="stringliteral">&#39;save_object, &quot;/open/dump&quot; }) );</span></div>
<div class="line"><span class="stringliteral">  bind_lambda(save,ob);</span></div>
<div class="line"><span class="stringliteral">  funcall(save);</span></div>
<div class="line"><span class="stringliteral">}</span></div>
</div><!-- fragment --><p> <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a> can also be used with efun closures.</p>
<ol type="1">
<li>It might be an interesting application to create closures dynamically as an alternative to writing LPC code to a file and then loading it. However, how do I avoid doing exactly that if I need symbols like <code>'x</code> or <code>'y</code>? To do that one uses <a class="el" href="classefun.html#a78e86c560d9bfc454fc228b3988db651" title="Converts arrays to quoted arrays and strings to symbols. ">efun::quote()</a>. It takes a string as its argument and transforms it into a symbol. For example, writing <code>quote("x")</code> is exactly the same as writing <code>'x</code>.</li>
<li>How do I test if a variable holds a closure? Use the <a class="el" href="classefun.html#af96696b3733777271624be5575c72726" title="Returns 1 if the argument is a closure. ">efun::closurep()</a> efun which works like all the other type testing efuns. For symbols there is also <a class="el" href="classefun.html#aa0bbde61230276ac5155fa61b54c63f2" title="Returns 1 if value is a symbol. ">efun::symbolp()</a> available.</li>
<li>That means, I can do: <code>if (closurep(f)) return funcall(f); else return f;</code> ? Yes, but in the case of <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> it is unnecessary. If <a class="el" href="classefun.html#a665f686219e1bffdb5e89a5158167473" title="Evaluates the closure. ">efun::funcall()</a> gets only one argument and it is not a closure it will be returned unchanged. So return <code>funcall(f);</code> would suffice.</li>
<li>I want to use a function in some object as a closure. How do I do that? There are several ways. If the function resides in <code>this_object()</code>, just use <code>#'func_name</code>. If not, or if you want to create the function dnynamically, use the efun <a class="el" href="classefun.html#a6f70cb143146d31cee7c413d2f0a0b9a" title="Constructs a lfun closure, efun closure, or operator closure from the first arg (string or symbol)...">efun::symbol_function()</a>. It takes a string as it first and an object as its second argument and returns a closure which upon evaluation calls the given function in the given object (and faster than <a class="el" href="classefun.html#a14431f7de9bcc796d309ac6f3193f5d4">efun::call_other()</a>, too, if done from inside a loop, since function search will be done only when calling <a class="el" href="classefun.html#a6f70cb143146d31cee7c413d2f0a0b9a" title="Constructs a lfun closure, efun closure, or operator closure from the first arg (string or symbol)...">efun::symbol_function()</a>.</li>
<li>Can I create efun closures dynamically, too? Yes, just use <a class="el" href="classefun.html#a6f70cb143146d31cee7c413d2f0a0b9a" title="Constructs a lfun closure, efun closure, or operator closure from the first arg (string or symbol)...">efun::symbol_function()</a> with a single argument. Most useful for marker objects and the like. But theoretically a security risk if not used properly and from inside a security relevant object. Take care, however, that, if there is a simul_efun with the same name, it will be preferred as in the case of <code>#'function</code>. Use the <code>efun::</code> modifier to get the efun if you need it.</li>
<li>Are there other uses of closures except using them to store code? Lots. For example, you can use them within almost all of the efuns where you give a function as an argument, like <a class="el" href="classefun.html#ac5e7282ed029a438608ee96f18052e33" title="Call the function &lt;ob&gt;-&gt;&lt;func&gt;() resp. ">efun::filter()</a>, <a class="el" href="classefun.html#a726e9875b6a71d74e719bf470c00bbf4" title="Sort the copy either by the ordering function ob-&gt;wrong_order(a, b), or by the closure expression cl...">efun::sort_array()</a> or <a class="el" href="classefun.html#a82aceeaafc69a2ea441ad52f4657e216" title="Calls ob-&gt;func(key, value1, ..., valueN, extra,...) resp. ">efun::walk_mapping()</a>. `sort_array(array,#'&gt;)` does indeed what is expected. Another application is <a class="el" href="classefun.html#a0f3aeee35045ba028e49b799747f610d" title="Set the prompt given by the first argument for the interactive object instead of the default prompt...">efun::set_prompt()</a>, where a closure can output your own prompt based on the current time and other stuff which changes all the time.</li>
</ol>
<p>Finally, there are some special efun/operator closures:</p>
<p>`#'[<code>: indexes an array. </code>#'[&lt;<code>: does the same, but starting at the end. </code>#'[..]<code>: gets an array and two numbers and returns a sub-array. </code>#'[..&lt;]<code>: same as above but the second index is interpreted as counted from the left end. </code>#'[&lt;..]<code>and </code>#'[&lt;..&lt;]<code>: should be clear now. </code>#'[..<code>: takes only one index and returns the sub- array from this index to the end. </code>#'[&lt;..<code>: same as above but the index is interpreted as counted from the left end. </code>#'({<code>: puts all arguments into an array. </code>#'([` : gets an unquoted (!) array which must include at least one element as argument and returns a mapping of the width of the given array's size with one entry that contains the first element as key and the other elements as values to the key.</p>
<p><code>#'negate</code> is for unary minus. <code>#'</code>, may be followed by any number of closures, e.g.: `({ (#',), ({#'= 'h, 'a, }), ({#'=, 'a, 'b }), ({#'=, 'b, 'h }) })` will swap 'a and 'b when compiled and executed.</p>
<h2>closures-abstract</h2>
<h3>Procedural elements</h3>
<p>definition of terms:</p>
<p><code>&lt;block&gt;</code> zero or more values to be evaluated.</p>
<p><code>&lt;test&gt;</code> one value to be evaluated as branch or loop condition.</p>
<p><code>&lt;result&gt;</code> one value to be evaluated at the end of the execution of the form; the value is returned.</p>
<p><code>&lt;lvalue&gt;</code> local variable/parameter, global variable, or an indexed lvalue.</p>
<p>used EBNF operators:</p>
<div class="fragment"><div class="line">{ }     iteration</div>
<div class="line">[ ]     option</div>
</div><!-- fragment --><p> forms:</p>
<ul>
<li>`({#', &lt;body&gt; &lt;result&gt;})<code> -</code>({#'? { &lt;test&gt; &lt;result&gt; } [ &lt;result&gt; ] })<code> -</code>({#'?! { &lt;test&gt; &lt;result&gt; } [ &lt;result&gt; ] })<code> -</code>({#'&amp;&amp; { test } })<code> -</code>({#'|| { test } })<code> -</code>({#'while &lt;test&gt; &lt;result&gt; &lt;body&gt;})<code>loop while test evaluates non-zero. -</code>({#'do &lt;body&gt; &lt;test&gt; &lt;result&gt;})<code>loop till test evaluates zero. -</code>({#'= { &lt;lvalue&gt; </li>
</ul>
<p>} })` assignment other assignment operators work, too.</p>
<p>lisp similars:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#&#39;,           progn</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#&#39;?           cond</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#&#39;&amp;&amp;          and</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#&#39;||          or</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#&#39;while       do      </span><span class="comment">/* but lisp has more syntactic candy here </span></div>
<div class="line"><span class="comment">#&#39;=           setq</span></div>
</div><!-- fragment --><p> A parameter / local variable 'foo' is referenced as 'foo , a global variable as <code>({#'foo})</code>. In lvalue positions (assignment), you need not enclose global variable closures in arrays.</p>
<p>Call by reference parameters are given with `({#'&amp;, &lt;lvalue&gt;})`</p>
<p>Some special efuns:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#&#39;[             indexing</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#&#39;[&lt;            indexing from the end</span></div>
<div class="line"><span class="preprocessor">#&#39;negate        unary -</span></div>
</div><!-- fragment --><h3>Unbound lambda closures</h3>
<p>These closures are not bound to any object. They are created with the efun <a class="el" href="classefun.html#ad7e5e12d8853c0b52534f8a8e57dcef6" title="Constructs a lambda closure that is not bound to an object, like lambda function in LISP...">efun::unbound_lambda()</a>. They cannot contain references to global variables, and all lfun closures are inserted as is, since there is no native object for this closure. You can bind and rebind unbound lambda closures to an object with efun <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a> You need to bind it before it can be called. Ordinary objects can obly bind to themselves, binding to other objects causes a privilege violation. The point is that previous_object for calls done from inside the closure will reflect the object doing <a class="el" href="classefun.html#a8e512d3268244957695f1a9fcf988f33" title="Binds an unbound lambda closure to an object and return it. ">efun::bind_lambda()</a>, and all object / uid based security will also refer to this object.</p>
<p>Authors MacBeth, Amylaar, Hyp</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="driver_syntax_closures-example.html">closures example</a>, <a class="el" href="driver_syntax_closure_guide.html">closures</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="driver_syntax_overview.html">LPC syntax</a></li>
    <li class="footer">Generated on Thu Mar 9 2017 17:45:24 for LDMud by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
