<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Tsunami: uids</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tsunami
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('driver_concepts_uids.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">uids </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Every object in the mud is attributed with a user-id 'uid': a string which associates the object with a certain 'user' (aka 'wizard' or 'creator', though it is not limited to that). The uid can be 0, which internally is the default-uid.</p>
<p>The uid serves a dual purpose: on the on hand it is used to gather statistics about the various groups of objects (in the famous 'wizlist'), on the other hand the uid can come in handy in the implementation of security systems.</p>
<p>The uid of an object is assigned at its creation through the driver hooks <a class="el" href="driver_hook_load_uids.html">H_LOAD_UIDS</a> for loaded objects, and <a class="el" href="driver_hook_clone_uids.html">H_CLONE_UIDS</a> for cloned objects, and can't be changed afterwards.</p>
<p>The uid of an object can be queried with the <a class="el" href="classefun.html#a1cee8cfd71595afe5cb29db76705b601" title="User-ids are not used in compat mode. ">efun::getuid()</a> (resp. creator() in compat-mode).</p>
<p>Every object also has a second string attribute, the 'effective userid' or 'euid', which also may be 0. This value was intended to implement a security system based on difference between theoretical and effective permissions. Since the effectiveness of this system is doubtful, the driver enforces such a use only as an option.</p>
<p>As uids, euids are assigned at an objects creation through the two aformentioned driverhooks. They can be queried with <a class="el" href="classefun.html#a8d2464ee0d105312cb194da96f14179d" title="Get the effective user-id of the object (mostly a wizard or domain name). ">efun::geteuid()</a> and changed with <a class="el" href="classefun.html#a681286799e121e42a3158f8ca5c2f2f4">efun::seteuid()</a>. Calls to the latter are verified by the master lfun ()`.</p>
<p>Additionally objects can impose their uid onto an other objects euid with the efun export_uid().</p>
<p>If the driver is run in 'strict euids' mode, euids are taken more seriously than being just another attribute:</p>
<ul>
<li>all objects must have a non-0 uid.</li>
<li>objects with a 0 euid can't load or clone other objects.</li>
<li>the backbone uid as returned by ::get_bb_uid()` must not be 0.</li>
</ul>
<p>Userids are assigned at the time of the creation of an object by calling the driverhooks H_LOAD_UIDS and H_CLONE_UIDS:</p>
<div class="fragment"><div class="line">mixed &lt;load_uids closure&gt; (<span class="keywordtype">string</span> objectname)</div>
<div class="line">mixed &lt;clone_uids closure&gt;(<span class="keywordtype">object</span> blueprint, <span class="keywordtype">string</span> objectname)</div>
</div><!-- fragment --><p> When an object is newly loaded, the H_LOAD_UIDS hook is called with the object name as argument.</p>
<p>When an object is cloned, the H_CLONE_UIDS hook is called with the blueprint object as first and the clone's designated name as second argument.</p>
<p>In both cases the new object already exists, but has 0 uids.</p>
<p>For the result, the following possibilities exist (&lt;num&gt; is a non-zero number, &lt;no-string&gt; is anything but a string):</p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>                    -&gt; uid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, euid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span></div>
<div class="line">({ <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, <span class="stringliteral">&quot;&lt;euid&gt;&quot;</span> })    -&gt; uid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, euid = <span class="stringliteral">&quot;&lt;euid&gt;&quot;</span></div>
<div class="line">({ <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, &lt;no-<span class="keywordtype">string</span>&gt; }) -&gt; uid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, euid = 0</div>
</div><!-- fragment --><p> If strict-euids is not active, the following results are possible, too:</p>
<div class="fragment"><div class="line">&lt;num&gt;                      -&gt; uid = <span class="stringliteral">&#39;default&#39;</span>, euid = 0</div>
<div class="line">({ &lt;num&gt;, <span class="stringliteral">&quot;&lt;euid&gt;&quot;</span> })      -&gt; uid = <span class="stringliteral">&#39;default&#39;</span>, euid = <span class="stringliteral">&quot;&lt;euid&gt;&quot;</span></div>
<div class="line">({ &lt;num&gt;, &lt;no-<span class="keywordtype">string</span>&gt; })   -&gt; uid = <span class="stringliteral">&#39;default&#39;</span>, euid = 0</div>
</div><!-- fragment --><p> Slightly different rules apply to the (e)uid of the master. The master's (e)uid is determined by a call to -&gt;get_master_uid()`:</p>
<div class="fragment"><div class="line"><span class="stringliteral">&quot;&lt;uid&quot;</span>&gt; -&gt; uid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span>, euid = <span class="stringliteral">&quot;&lt;uid&gt;&quot;</span></div>
</div><!-- fragment --><p> In non-strict-euids mode, more results are possible:</p>
<div class="fragment"><div class="line">0       -&gt; uid = 0, euid = 0</div>
<div class="line">&lt;num&gt;   -&gt; uid = <span class="stringliteral">&#39;default&#39;</span>, euid = 0</div>
</div><!-- fragment --><p> If your uids are in general based on filenames, it is wise to return a value here which can not be legally generated from any filename. OSB for example uses 'ze/us'.</p>
<p>The masters uid is determined only on startup this way, at runtime the uids of a reloaded master determined as for every object by a call to the appropriate driver hooks.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="driver_concepts_native.html">native</a>, <a class="el" href="classmaster.html#aa06fcea93427b8ad27a586c20a20f9ec" title="Return the string to be used as root-uid. ">master::get_root_uid()</a>, <a class="el" href="classmaster.html#a0c44ada9ac997960fdfa18d1f29249c0" title="Should return 1 if ob is allowed to set its euid to newid. ">master::valid_seteuid()</a>, <a class="el" href="driver_concepts_objects.html">objects</a>, <a class="el" href="classefun.html#ac48b7a182d90218465e671cd6f2dcd68">efun::clone_object()</a>, <a class="el" href="classefun.html#a8d2464ee0d105312cb194da96f14179d" title="Get the effective user-id of the object (mostly a wizard or domain name). ">efun::geteuid()</a>, <a class="el" href="classefun.html#a1cee8cfd71595afe5cb29db76705b601" title="User-ids are not used in compat mode. ">efun::getuid()</a>, <a class="el" href="classefun.html#a681286799e121e42a3158f8ca5c2f2f4">efun::seteuid()</a> </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="driver_concepts_concepts.html">concepts</a></li>
    <li class="footer">Generated on Tue Jun 7 2016 19:15:59 for Tsunami by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
