<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>H_CLEAN_UP &mdash; LDMud UNRELEASED documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'UNRELEASED',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="LDMud UNRELEASED documentation" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="H_CLEAN_UP">
<div class="section" id="SYNOPSIS">
<span id="lpc.clean_up"></span><h2>SYNOPSIS<a class="headerlink" href="#SYNOPSIS" title="Permalink to this headline">¶</a></h2>
<dl class="hook">
<dl class="include">
<dt>
#include &lt;sys/driver_hooks.h&gt;</dt>
</dl>

<dt id="lpc.H_CLEAN_UP">
<code class="descname">set_driver_hook</code><span class="sig-paren">(</span><em>H_CLEAN_UP</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#lpc.H_CLEAN_UP" title="Permalink to this definition">¶</a></dt>
</dl>

</div>
<div class="section" id="DESCRIPTION">
<h2>DESCRIPTION<a class="headerlink" href="#DESCRIPTION" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Arguments:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> (<em>closure</em>) &#8211; int &lt;closure&gt;(int ref, object ob)</li>
<li><strong>value</strong> (<em>string</em>) &#8211; void|int &lt;name&gt;(int ref)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Optional hook to clean up an object. Hook setting can be any
closure, or the name of the function to call in the object.</p>
<p>This hook is called for an object if it hasn&#8217;t been used
for at least TIME_TO_CLEAN_UP seconds, to give it the
opportunity to self destruct.</p>
<p>If the hook is a closure, it is called with the refcount of
the object to clean up as first argument, and with the object
itself as second. Lambda closures are also bound to the object
prior to the call.</p>
<p>If the hook is the name of an lfun, it is called in the
object with its refcount as argument.</p>
<p>In both calls, the refcount is constructed as:</p>
<blockquote>
<div><dl class="docutils">
<dt>ref = 0: the object is a clone, or a blueprint with</dt>
<dd>replaced program.</dd>
</dl>
<p>ref = 1: the object is a swapped or unused blueprint.
ref &gt; 1: the object is a used blueprint with <span class="xref lpc lpc-any">ref</span> references.</p>
</div></blockquote>
<p>The cleanup method has the possibility to destruct the
object. To survive this time, but try again some time later,
the call has to result in a non-zero value.</p>
<p>If the hook specifies a non-existing lfun, or if the call
returns 0, no further attempt to clean up this object will be made.</p>
<h2 id="see2also">SEE ALSO<a class="headerlink" href="#DESCRIPTION" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="hook.html#lpc.hooks" title="hooks"><span class="xref lpc lpc-concept">hooks</span></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">H_CLEAN_UP</a><ul>
<li><a class="reference internal" href="#SYNOPSIS">SYNOPSIS</a></li>
<li><a class="reference internal" href="#DESCRIPTION">DESCRIPTION</a></li>
</ul>
</li>
</ul>
<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hook.html">hooks</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;good question.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="../_sources/hook/clean_up.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>